                                                format MZ
                                                
00000020: 0E                                    push cs
00000021: 1F                                    pop ds
00000022: 0E                                    push cs
00000023: 07                                    pop es
                                                
                                                
                                                ;set video mode
00000024: B4 00                                 mov ah,0
00000026: B0 10                                 mov al,0x10 ;vga 640x350  16 colors
00000028: CD 10                                 int 0x10
                                                
                                                mainLoop:
0000002A: E8 0E 00                              call clearScreen
0000002D: E8 6C 00                              call drawBackground
00000030: E8 8C 00                              call drawObjects
00000033: E8 1D 01                              call readInput
00000036: E8 62 01                              call updateState
00000039: EB EF                                 jmp mainLoop
                                                
                                                clearScreen:
0000003B: C6 06 CF 03 00                        mov [CURR_COLOR],0
00000040: EB 0F                                 jmp repaintBall
                                                cs2:
00000042: 83 3E DC 03 00                        cmp [P1_DY],0
00000047: 75 2B                                 jnz repaintP1
                                                cs1:
00000049: 83 3E DE 03 00                        cmp [P2_DY],0
0000004E: 75 38                                 jnz repaintP2
                                                @@:
                                                
00000050: C3                                    ret
                                                repaintBall:
00000051: A1 DA 03                              mov ax,[B_Y]
00000054: 50                                    push ax
00000055: 2B 06 E2 03                           sub ax,[B_DY]
00000059: A3 DA 03                              mov [B_Y],ax
0000005C: A1 D8 03                              mov ax,[B_X]
0000005F: 50                                    push ax
00000060: 2B 06 E0 03                           sub ax,[B_DX]
00000064: A3 D8 03                              mov [B_X],ax
00000067: E8 65 00                              call drawBall
0000006A: 58                                    pop ax
0000006B: A3 D8 03                              mov [B_X],ax
0000006E: 58                                    pop ax
0000006F: A3 DA 03                              mov [B_Y],ax
00000072: EB CE                                 jmp cs2
                                                
                                                repaintP1:
00000074: A1 D2 03                              mov ax,[P1_Y]
00000077: 50                                    push ax
00000078: 2B 06 DC 03                           sub ax,[P1_DY]
0000007C: A3 D2 03                              mov [P1_Y],ax
0000007F: E8 79 00                              call drawP1Bar
00000082: 58                                    pop ax
00000083: A3 D2 03                              mov [P1_Y],ax
00000086: EB C1                                 jmp cs1
                                                
                                                repaintP2:
00000088: A1 D6 03                              mov ax,[P2_Y]
0000008B: 50                                    push ax
0000008C: 2B 06 DE 03                           sub ax,[P2_DY]
00000090: A3 D6 03                              mov [P2_Y],ax
00000093: E8 91 00                              call drawP2Bar
00000096: 58                                    pop ax
00000097: A3 D6 03                              mov [P2_Y],ax
0000009A: EB B4                                 jmp @r
                                                
                                                
                                                
                                                drawBackground:
0000009C: A0 CE 03                              mov al,[OBJ_COLOR]
0000009F: A2 CF 03                              mov [CURR_COLOR],al
000000A2: C7 06 1F 04 00 00                     mov [x1],0
000000A8: A1 27 04                              mov ax,[MAX_X]
000000AB: A3 21 04                              mov [x2],ax
000000AE: C7 06 23 04 00 00                     mov [y1],0
000000B4: A1 29 04                              mov ax,[MAX_Y]
000000B7: A3 25 04                              mov [y2],ax
000000BA: E8 76 02                              call drawRectangle
000000BD: C3                                    ret
000000BE: C3                                    ret
                                                
                                                drawObjects:
000000BF: A0 CE 03                              mov al,[OBJ_COLOR]
000000C2: A2 CF 03                              mov [CURR_COLOR],al
000000C5: E8 07 00                              call drawBall
000000C8: E8 30 00                              call drawP1Bar
000000CB: E8 59 00                              call drawP2Bar
000000CE: C3                                    ret
                                                
                                                drawBall:
000000CF: A1 D8 03                              mov ax,[B_X]
000000D2: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
000000D6: A3 1F 04                              mov [x1],ax
                                                
000000D9: A1 D8 03                              mov ax,[B_X]
000000DC: 03 06 E6 03                           add ax,[BORDER_SIZE]
000000E0: A3 21 04                              mov [x2],ax
                                                
000000E3: A1 DA 03                              mov ax,[B_Y]
000000E6: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
000000EA: A3 23 04                              mov [y1],ax
                                                
000000ED: A1 DA 03                              mov ax,[B_Y]
000000F0: 03 06 E6 03                           add ax,[BORDER_SIZE]
000000F4: A3 25 04                              mov [y2],ax
000000F7: E8 39 02                              call drawRectangle
000000FA: C3                                    ret
                                                
                                                drawP1Bar:
000000FB: A1 D0 03                              mov ax,[P1_X]
000000FE: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
00000102: A3 1F 04                              mov [x1],ax
                                                
00000105: A1 D0 03                              mov ax,[P1_X]
00000108: 03 06 E6 03                           add ax,[BORDER_SIZE]
0000010C: A3 21 04                              mov [x2],ax
                                                
0000010F: A1 D2 03                              mov ax,[P1_Y]
00000112: 2B 06 E4 03                           sub ax,[BAR_HEIGHT]
00000116: A3 23 04                              mov [y1],ax
                                                
00000119: A1 D2 03                              mov ax,[P1_Y]
0000011C: 03 06 E4 03                           add ax,[BAR_HEIGHT]
00000120: A3 25 04                              mov [y2],ax
00000123: E8 0D 02                              call drawRectangle
00000126: C3                                    ret
                                                
                                                drawP2Bar:
00000127: A1 D4 03                              mov ax,[P2_X]
0000012A: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
0000012E: A3 1F 04                              mov [x1],ax
                                                
00000131: A1 D4 03                              mov ax,[P2_X]
00000134: 03 06 E6 03                           add ax,[BORDER_SIZE]
00000138: A3 21 04                              mov [x2],ax
                                                
0000013B: A1 D6 03                              mov ax,[P2_Y]
0000013E: 2B 06 E4 03                           sub ax,[BAR_HEIGHT]
00000142: A3 23 04                              mov [y1],ax
                                                
00000145: A1 D6 03                              mov ax,[P2_Y]
00000148: 03 06 E4 03                           add ax,[BAR_HEIGHT]
0000014C: A3 25 04                              mov [y2],ax
0000014F: E8 E1 01                              call drawRectangle
00000152: C3                                    ret
                                                
                                                readInput:
                                                
00000153: B4 01                                 mov ah,1
00000155: CD 16                                 int 0x16
00000157: 75 01                                 jnz keyPressed
                                                @@:
00000159: C3                                    ret
                                                keyPressed:
0000015A: B4 00                                 mov ah,0
0000015C: CD 16                                 int 0x16
0000015E: 80 FC 11                              cmp ah,0x11
00000161: 74 18                                 jz w
00000163: 80 FC 1F                              cmp ah,0x1f
00000166: 74 1B                                 jz s
00000168: 80 FC 17                              cmp ah,0x17
0000016B: 74 1E                                 jz i
0000016D: 80 FC 25                              cmp ah,0x25
00000170: 74 21                                 jz k
00000172: 80 FC 01                              cmp ah,1
00000175: 0F 84 67 02                           jz exit
00000179: EB DE                                 jmp @r
                                                w:
0000017B: C7 06 DC 03 FF FF                     mov [P1_DY],-1
00000181: EB D6                                 jmp @r
                                                s:
00000183: C7 06 DC 03 01 00                     mov [P1_DY],1
00000189: EB CE                                 jmp @r
                                                i:
0000018B: C7 06 DE 03 FF FF                     mov [P2_DY],-1
00000191: EB C6                                 jmp @r
                                                k:
00000193: C7 06 DE 03 01 00                     mov [P2_DY],1
00000199: EB BE                                 jmp @r
                                                
                                                
                                                updateState:
0000019B: A1 D2 03                              mov ax,[P1_Y]
0000019E: 03 06 DC 03                           add ax,[P1_DY]
000001A2: A3 D2 03                              mov [P1_Y],ax
                                                
000001A5: B8 DC 03                              mov ax,P1_DY
000001A8: FF 36 D2 03                           push [P1_Y]
000001AC: 50                                    push ax
000001AD: E8 31 00                              call checkPCollision
000001B0: 58                                    pop ax
000001B1: 58                                    pop ax
                                                
000001B2: A1 D6 03                              mov ax,[P2_Y]
000001B5: 03 06 DE 03                           add ax,[P2_DY]
000001B9: A3 D6 03                              mov [P2_Y],ax
                                                
                                                
000001BC: B8 DE 03                              mov ax,P2_DY
000001BF: FF 36 D6 03                           push [P2_Y]
000001C3: 50                                    push ax
000001C4: E8 1A 00                              call checkPCollision
000001C7: 58                                    pop ax
000001C8: 58                                    pop ax
                                                
                                                
000001C9: A1 D8 03                              mov ax,[B_X]
000001CC: 03 06 E0 03                           add ax,[B_DX]
000001D0: A3 D8 03                              mov [B_X],ax
000001D3: A1 DA 03                              mov ax,[B_Y]
000001D6: 03 06 E2 03                           add ax,[B_DY]
000001DA: A3 DA 03                              mov [B_Y],ax
                                                
000001DD: E8 3A 00                              call checkBallCollision
000001E0: C3                                    ret
                                                
                                                
                                                checkPCollision:
000001E1: 55                                    push bp
000001E2: 89 E5                                 mov bp,sp
                                                
000001E4: 8B 46 06                              mov ax,[bp+6]
000001E7: 03 06 E4 03                           add ax,[BAR_HEIGHT]
000001EB: 89 C2                                 mov dx,ax
000001ED: A1 29 04                              mov ax,[MAX_Y]
000001F0: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
000001F4: 39 C2                                 cmp dx,ax
000001F6: 74 16                                 jz pBorderHit
                                                
000001F8: B8 00 00                              mov ax,0
000001FB: 03 06 E6 03                           add ax,[BORDER_SIZE]
000001FF: 89 C2                                 mov dx,ax
00000201: 8B 46 06                              mov ax,[bp+6]
                                                
00000204: 2B 06 E4 03                           sub ax,[BAR_HEIGHT]
00000208: 39 D0                                 cmp ax,dx
0000020A: 74 02                                 jz pBorderHit
0000020C: EB 08                                 jmp @f
                                                
                                                pBorderHit:
0000020E: B8 00 00                              mov ax,0
00000211: 8B 7E 04                              mov di,[bp+4]
00000214: 89 05                                 mov [di],ax
                                                
                                                @@:
                                                
00000216: 89 EC                                 mov sp,bp
00000218: 5D                                    pop bp
00000219: C3                                    ret
                                                
                                                
                                                checkBallCollision:
0000021A: B8 00 00                              mov ax,0
0000021D: 03 06 E6 03                           add ax,[BORDER_SIZE]
00000221: 89 C2                                 mov dx,ax
00000223: A1 D8 03                              mov ax,[B_X]
00000226: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
0000022A: 39 D0                                 cmp ax,dx
0000022C: 0F 84 AE 00                           jz p2Win
                                                w1:
00000230: 89 C2                                 mov dx,ax
00000232: A1 D0 03                              mov ax,[P1_X]
00000235: 03 06 E6 03                           add ax,[BORDER_SIZE]
00000239: 39 D0                                 cmp ax,dx
0000023B: 75 2C                                 jnz @f
0000023D: A1 D2 03                              mov ax,[P1_Y]
00000240: 03 06 E4 03                           add ax,[BAR_HEIGHT]
00000244: 89 C2                                 mov dx,ax
00000246: A1 DA 03                              mov ax,[B_Y]
00000249: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
0000024D: 40                                    inc ax
0000024E: 39 D0                                 cmp ax,dx
00000250: 7D 17                                 jge @f
00000252: A1 D2 03                              mov ax,[P1_Y]
00000255: 2B 06 E4 03                           sub ax,[BAR_HEIGHT]
00000259: 89 C2                                 mov dx,ax
0000025B: A1 DA 03                              mov ax,[B_Y]
0000025E: 03 06 E6 03                           add ax,[BORDER_SIZE]
00000262: 39 D0                                 cmp ax,dx
00000264: 7E 03                                 jle @f
00000266: E9 92 00                              jmp changeXDir
                                                
                                                
                                                
                                                
                                                @@:
00000269: A1 27 04                              mov ax,[MAX_X]
0000026C: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
00000270: 89 C2                                 mov dx,ax
00000272: A1 D8 03                              mov ax,[B_X]
00000275: 03 06 E6 03                           add ax,[BORDER_SIZE]
00000279: 39 D0                                 cmp ax,dx
0000027B: 74 70                                 jz p1Win
                                                w2:
0000027D: 89 C2                                 mov dx,ax
0000027F: A1 D4 03                              mov ax,[P2_X]
00000282: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
00000286: 39 C2                                 cmp dx,ax
00000288: 75 2B                                 jnz @f
0000028A: A1 D6 03                              mov ax,[P2_Y]
0000028D: 03 06 E4 03                           add ax,[BAR_HEIGHT]
00000291: 89 C2                                 mov dx,ax
00000293: A1 DA 03                              mov ax,[B_Y]
00000296: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
0000029A: 40                                    inc ax
0000029B: 39 D0                                 cmp ax,dx
0000029D: 7D 16                                 jge @f
0000029F: A1 D6 03                              mov ax,[P2_Y]
000002A2: 2B 06 E4 03                           sub ax,[BAR_HEIGHT]
000002A6: 89 C2                                 mov dx,ax
000002A8: A1 DA 03                              mov ax,[B_Y]
000002AB: 03 06 E6 03                           add ax,[BORDER_SIZE]
000002AF: 39 D0                                 cmp ax,dx
000002B1: 7E 02                                 jle @f
000002B3: EB 46                                 jmp changeXDir
                                                
                                                
                                                
                                                @@:
000002B5: B8 00 00                              mov ax,0
000002B8: 03 06 E6 03                           add ax,[BORDER_SIZE]
000002BC: 89 C2                                 mov dx,ax
000002BE: A1 DA 03                              mov ax,[B_Y]
000002C1: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
000002C5: 39 D0                                 cmp ax,dx
000002C7: 74 37                                 jz changeYDir
                                                w3:
000002C9: A1 29 04                              mov ax,[MAX_Y]
000002CC: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
000002D0: 89 C2                                 mov dx,ax
000002D2: A1 DA 03                              mov ax,[B_Y]
000002D5: 03 06 E6 03                           add ax,[BORDER_SIZE]
000002D9: 39 D0                                 cmp ax,dx
000002DB: 74 23                                 jz changeYDir
                                                
000002DD: C3                                    ret
                                                
                                                
                                                
                                                
                                                
                                                p2Win:
                                                
000002DE: FF 36 04 04                           push [P2_WIN_LEN]
000002E2: 68 F7 03                              push P2_WIN
000002E5: E8 1D 00                              call showWinner
000002E8: 5A                                    pop dx
000002E9: 5A                                    pop dx
000002EA: E9 43 FF                              jmp w1
                                                
                                                
                                                
                                                p1Win:
000002ED: FF 36 04 04                           push [P2_WIN_LEN]
000002F1: 68 E8 03                              push P1_WIN
000002F4: E8 0E 00                              call showWinner
000002F7: 5A                                    pop dx
000002F8: 5A                                    pop dx
000002F9: EB 82                                 jmp w2
                                                
                                                
                                                changeXDir:
000002FB: F7 1E E0 03                           neg [B_DX]
000002FF: C3                                    ret
                                                
                                                changeYDir:
00000300: F7 1E E2 03                           neg [B_DY]
                                                
00000304: C3                                    ret
                                                
                                                
                                                
                                                showWinner:
00000305: 55                                    push bp
00000306: 89 E5                                 mov bp,sp
00000308: B4 13                                 mov ah,0x13
0000030A: B0 01                                 mov al,1
0000030C: B7 00                                 mov bh,0
0000030E: B3 0C                                 mov bl,1100b
00000310: 8B 4E 06                              mov cx,[bp+6]
00000313: B2 1E                                 mov dl,30 ;col
00000315: B6 0A                                 mov dh,10 ;row
00000317: 8B 6E 04                              mov bp,[bp+4]
0000031A: CD 10                                 int 0x10
0000031C: 8B 0E 1B 04                           mov cx,[EXIT_MSG_LEN]
00000320: B2 1A                                 mov dl,26
00000322: B6 0B                                 mov dh,11
00000324: BD 06 04                              mov bp, EXIT_MSG
00000327: CD 10                                 int 0x10
                                                
00000329: 89 EC                                 mov sp,bp
0000032B: 5D                                    pop bp
0000032C: E8 AC 00                              call keyPause
0000032F: E8 AE 00                              call exit
00000332: C3                                    ret
                                                
                                                drawRectangle:
00000333: B4 0C                                 mov ah,0x0c
00000335: A0 CF 03                              mov al,[CURR_COLOR]
00000338: B7 00                                 mov bh,0
                                                
                                                ;upper bound
0000033A: 8B 16 23 04                           mov dx,[y1]
0000033E: 50                                    push ax
0000033F: 89 D0                                 mov ax,dx
00000341: 03 06 E6 03                           add ax,[BORDER_SIZE]
00000345: A3 1D 04                              mov [t0],ax
00000348: FF 06 1D 04                           inc [t0]
0000034C: 58                                    pop ax
                                                d1:
0000034D: 8B 0E 21 04                           mov cx,[x2]
00000351: 41                                    inc cx
                                                @@:  
00000352: B4 00                                 mov ah, 0
00000354: B0 13                                 mov al, 13h
00000356: CD 10                                 int 10h
00000358: 49                                    dec cx
00000359: CD 10                                 int 0x10
0000035B: 3B 0E 1F 04                           cmp cx,[x1]
0000035F: 75 F1                                 jnz @r
00000361: 42                                    inc dx
00000362: 39 16 1D 04                           cmp [t0],dx
00000366: 75 E5                                 jnz d1
                                                
                                                ;lower bound
00000368: 8B 16 25 04                           mov dx,[y2]
0000036C: 50                                    push ax
0000036D: 89 D0                                 mov ax,dx
0000036F: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
00000373: A3 1D 04                              mov [t0],ax
00000376: FF 0E 1D 04                           dec [t0]
0000037A: 58                                    pop ax
                                                d2:
0000037B: 8B 0E 21 04                           mov cx,[x2]
0000037F: 41                                    inc cx
                                                @@:
00000380: 49                                    dec cx
00000381: CD 10                                 int 0x10
00000383: 3B 0E 1F 04                           cmp cx,[x1]
00000387: 75 F7                                 jnz @r
00000389: 4A                                    dec dx
0000038A: 39 16 1D 04                           cmp [t0],dx
0000038E: 75 EB                                 jnz d2
                                                
                                                ;left bound
00000390: 8B 0E 1F 04                           mov cx,[x1]
00000394: 49                                    dec cx
00000395: 50                                    push ax
00000396: 89 C8                                 mov ax,cx
00000398: 03 06 E6 03                           add ax,[BORDER_SIZE]
0000039C: A3 1D 04                              mov [t0],ax
0000039F: 58                                    pop ax
                                                d3:
000003A0: 41                                    inc cx
000003A1: 8B 16 25 04                           mov dx,[y2]
000003A5: 42                                    inc dx
                                                @@:
000003A6: 4A                                    dec dx
000003A7: CD 10                                 int 0x10
000003A9: 3B 16 23 04                           cmp dx,[y1]
000003AD: 75 F7                                 jnz @r
000003AF: 39 0E 1D 04                           cmp [t0],cx
000003B3: 75 EB                                 jnz d3
                                                
                                                ;right bound
000003B5: 8B 0E 21 04                           mov cx,[x2]
000003B9: 41                                    inc cx
000003BA: 50                                    push ax
000003BB: 89 C8                                 mov ax,cx
000003BD: 2B 06 E6 03                           sub ax,[BORDER_SIZE]
000003C1: A3 1D 04                              mov [t0],ax
000003C4: 58                                    pop ax
                                                d4:
000003C5: 49                                    dec cx
000003C6: 8B 16 25 04                           mov dx,[y2]
000003CA: 42                                    inc dx
                                                @@:
000003CB: 4A                                    dec dx
000003CC: CD 10                                 int 0x10
000003CE: 3B 16 23 04                           cmp dx,[y1]
000003D2: 75 F7                                 jnz @r
000003D4: 39 0E 1D 04                           cmp [t0],cx
000003D8: 75 EB                                 jnz d4
000003DA: C3                                    ret
                                                
                                                
                                                keyPause:
000003DB: B4 00                                 mov ah,0
000003DD: CD 16                                 int 0x16
000003DF: C3                                    ret
                                                
                                                exit:
000003E0: B4 00                                 mov ah,0
000003E2: B0 02                                 mov al,2
000003E4: CD 10                                 int 0x10
000003E6: B8 00 4C                              mov ax,0x4c00
000003E9: CD 21                                 int 0x21
                                                
                                                
                                                
000003EB: 01                                    P1_COLOR db 1
000003EC: 02                                    P2_COLOR db 2
000003ED: 00                                    BG_COLOR db 0
000003EE: 03                                    OBJ_COLOR db 3
000003EF: 10                                    CURR_COLOR db 16
                                                
000003F0: 14 00                                 P1_X dw 20
000003F2: 96 00                                 P1_Y dw 150
000003F4: 6C 02                                 P2_X dw 620
000003F6: 96 00                                 P2_Y dw 150
000003F8: 2C 01                                 B_X dw 300
000003FA: 96 00                                 B_Y dw 150
                                                
000003FC: 00 00                                 P1_DY dw 0
000003FE: 00 00                                 P2_DY dw 0
00000400: 01 00                                 B_DX dw 1
00000402: 01 00                                 B_DY dw 1
                                                
00000404: 32 00                                 BAR_HEIGHT dw 50
00000406: 02 00                                 BORDER_SIZE dw 2
                                                
00000408: 50 6C 61 79 65 72 20 31 20 57 6F 6E   P1_WIN db 'Player 1 Won!'
          21                                    
00000415: 0D 00                                 P1_WIN_LEN dw $-P1_WIN
00000417: 50 6C 61 79 65 72 20 32 20 57 6F 6E   P2_WIN db 'Player 2 Won!'
          21                                    
00000424: 0D 00                                 P2_WIN_LEN dw $-P2_WIN
00000426: 50 72 65 73 73 20 61 6E 79 20 6B 65   EXIT_MSG db 'Press any key to exit'
          79 20 74 6F 20 65 78 69 74            
0000043B: 15 00                                 EXIT_MSG_LEN dw $-EXIT_MSG
                                                
0000043D: 00 00                                 t0 dw 0
0000043F: 00 00                                 x1 dw 0
00000441: 00 00                                 x2 dw 0
00000443: 00 00                                 y1 dw 0
00000445: 00 00                                 y2 dw 0
00000447: 7F 02                                 MAX_X dw 639
00000449: 5D 01                                 MAX_Y dw 349
                                                
                                                
                                                
                                                ; [SOURCE]: C:\Users\Juan\Desktop\pong.asm
                                                
                                                
